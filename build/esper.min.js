!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.esper=e()}}(function(){return function e(t,r,i){function n(a,f){if(!r[a]){if(!t[a]){var u="function"==typeof require&&require;if(!f&&u)return u(a,!0);if(o)return o(a,!0);var s=new Error("Cannot find module '"+a+"'");throw s.code="MODULE_NOT_FOUND",s}var h=r[a]={exports:{}};t[a][0].call(h.exports,function(e){var r=t[a][1][e];return n(r?r:e)},h,h.exports,e,t,r,i)}return r[a].exports}for(var o="function"==typeof require&&require,a=0;a<i.length;a++)n(i[a]);return n}({1:[function(e,t,r){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}!function(){var r=e("./Texture2D"),a=e("../util/ImageLoader"),f=e("../util/Util"),u={NEAREST:!0,LINEAR:!0},s={NEAREST:!0,LINEAR:!0,NEAREST_MIPMAP_NEAREST:!0,LINEAR_MIPMAP_NEAREST:!0,NEAREST_MIPMAP_LINEAR:!0,LINEAR_MIPMAP_LINEAR:!0},h={REPEAT:!0,MIRRORED_REPEAT:!0,CLAMP_TO_EDGE:!0},c={UNSIGNED_BYTE:!0,FLOAT:!0},l={RGB:!0,RGBA:!0},E="UNSIGNED_BYTE",p="RGBA",d="REPEAT",v="LINEAR",T=!0,y=!0,m=!0,_=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],r=arguments.length<=1||void 0===arguments[1]?null:arguments[1];if(i(this,t),e.wrapS=e.wrapS||e.wrap,e.wrapT=e.wrapT||e.wrap,e.minFilter=e.minFilter||e.filter,e.magFilter=e.magFilter||e.filter,e.wrapS=h[e.wrapS]?e.wrapS:d,e.wrapT=h[e.wrapT]?e.wrapT:d,e.minFilter=s[e.minFilter]?e.minFilter:v,e.magFilter=u[e.magFilter]?e.magFilter:v,e.mipMap=void 0!==e.mipMap?e.mipMap:y,e.invertY=void 0!==e.invertY?e.invertY:m,e.preMultiplyAlpha=void 0!==e.preMultiplyAlpha?e.preMultiplyAlpha:T,e.format=l[e.format]?e.format:p,"string"==typeof e.src){e.type="UNSIGNED_BYTE";var o=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));a.load({url:e.src,success:function(t){t=f.resizeCanvas(e,t),o.bufferData(t,e.width,e.height),o.setParameters(o),r&&r(null,o)},error:function(e){r&&r(e,null)}})}else if(f.isCanvasType(e.src)){e.type="UNSIGNED_BYTE",e.src=f.resizeCanvas(e,e.src);var o=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}else{void 0!==e.src&&null!==e.src||(e.mipMap=!1),e.type=c[e.type]?e.type:E;var o=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return n(o)}return o(t,e),t}(r);t.exports=_}()},{"../util/ImageLoader":16,"../util/Util":17,"./Texture2D":8}],2:[function(e,t,r){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}!function(){var r=e("./Texture2D"),a={NEAREST:!0,LINEAR:!0},f={NEAREST:!0,LINEAR:!0},u={REPEAT:!0,CLAMP_TO_EDGE:!0,MIRRORED_REPEAT:!0},s={UNSIGNED_BYTE:!0,UNSIGNED_SHORT:!0,UNSIGNED_INT:!0},h={DEPTH_COMPONENT:!0,DEPTH_STENCIL:!0},c="UNSIGNED_INT",l="DEPTH_COMPONENT",E="CLAMP_TO_EDGE",p="LINEAR",d=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return i(this,t),e.wrapS=e.wrapS||e.wrap,e.wrapT=e.wrapT||e.wrap,e.minFilter=e.minFilter||e.filter,e.magFilter=e.magFilter||e.filter,e.wrapS=u[e.wrapS]?e.wrapS:E,e.wrapT=u[e.wrapT]?e.wrapT:E,e.minFilter=f[e.minFilter]?e.minFilter:p,e.magFilter=a[e.magFilter]?e.magFilter:p,e.mipMap=!1,e.invertY=!1,e.preMultiplyAlpha=!1,e.format=h[e.format]?e.format:l,"DEPTH_STENCIL"===e.format?e.type="UNSIGNED_INT_24_8_WEBGL":e.type=s[e.type]?e.type:c,n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return o(t,e),t}(r);t.exports=d}()},{"./Texture2D":8}],3:[function(e,t,r){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}();!function(){var r=e("./WebGLContext"),o={UNSIGNED_BYTE:!0,UNSIGNED_SHORT:!0,UNSIGNED_INT:!0},a={POINTS:!0,LINES:!0,LINE_STRIP:!0,LINE_LOOP:!0,TRIANGLES:!0,TRIANGLE_STRIP:!0,TRIANGLE_FAN:!0},f={UNSIGNED_BYTE:1,UNSIGNED_SHORT:2,UNSIGNED_INT:4},u="UNSIGNED_SHORT",s="TRIANGLES",h=0,c=0,l=function(){function e(t){var n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];if(i(this,e),this.gl=r.get(),this.buffer=null,this.type=o[n.type]?n.type:u,this.mode=a[n.mode]?n.mode:s,this.count=void 0!==n.count?n.count:c,this.byteOffset=void 0!==n.byteOffset?n.byteOffset:h,this.byteLength=0,t)if(t instanceof WebGLBuffer){if(void 0===n.byteLength)throw"Argument of type WebGLBuffer` must be complimented with a corresponding `options.byteLength`";this.byteLength=n.byteLength,this.buffer=t}else if(Number.isInteger(t)){if(void 0===n.type)throw"Argument of type `number` must be complimented with a corresponding `options.type`";this.bufferData(t)}else if(t instanceof ArrayBuffer){if(void 0===n.type)throw"Argument of type `ArrayBuffer` must be complimented with a corresponding `options.type`";this.bufferData(t)}else this.bufferData(t);else if(void 0===n.type)throw"Empty buffer must be complimented with a corresponding `options.type`"}return n(e,[{key:"bufferData",value:function(e){var t=this.gl;if(Array.isArray(e))e="UNSIGNED_INT"===this.type?new Uint32Array(e):"UNSIGNED_SHORT"===this.type?new Uint16Array(e):new Uint8Array(e);else if(e instanceof Uint32Array)this.type="UNSIGNED_INT";else if(e instanceof Uint16Array)this.type="UNSIGNED_SHORT";else if(e instanceof Uint8Array)this.type="UNSIGNED_BYTE";else if(!(e instanceof ArrayBuffer||Number.isInteger(e)))throw"Argument must be of type `Array`, `ArrayBuffer`, `ArrayBufferView`, or `number`";if("UNSIGNED_INT"===this.type&&!r.checkExtension("OES_element_index_uint"))throw"Cannot create IndexBuffer of type `UNSIGNED_INT` as extension `OES_element_index_uint` is not supported";return this.count===c&&(Number.isInteger(e)?this.count=e/f[this.type]:this.count=e.length),Number.isInteger(e)?this.byteLength=e:this.byteLength=e.byteLength,this.buffer||(this.buffer=t.createBuffer()),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.buffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,e,t.STATIC_DRAW),this}},{key:"bufferSubData",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?h:arguments[1],r=this.gl;if(!this.buffer)throw"Buffer has not yet been allocated, allocate with `bufferData`";if(Array.isArray(e))e="UNSIGNED_INT"===this.type?new Uint32Array(e):"UNSIGNED_SHORT"===this.type?new Uint16Array(e):new Uint8Array(e);else if(!(e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Uint32Array||e instanceof ArrayBuffer))throw"Argument must be of type `Array`, `ArrayBuffer`, or `ArrayBufferView`";if(t+e.byteLength>this.byteLength)throw"Argument of length "+e.byteLength+" bytes with "+("offset of "+t+" bytes overflows the buffer ")+("length of "+this.byteLength+" bytes");return r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,this.buffer),r.bufferSubData(r.ELEMENT_ARRAY_BUFFER,t,e),this}},{key:"draw",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=this.gl,r=t[e.mode||this.mode],i=t[this.type],n=void 0!==e.byteOffset?e.byteOffset:this.byteOffset,o=void 0!==e.count?e.count:this.count;if(0===o)throw"Attempting to draw with a count of 0";return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.buffer),t.drawElements(r,o,i,n),this}}]),e}();t.exports=l}()},{"./WebGLContext":13}],4:[function(e,t,r){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}();!function(){var r=e("./WebGLContext"),o={TEXTURE_2D:!0,TEXTURE_CUBE_MAP:!0},a={DEPTH_COMPONENT:!0,DEPTH_STENCIL:!0},f=function(){function e(){i(this,e),this.gl=r.get(),this.framebuffer=this.gl.createFramebuffer(),this.textures={}}return n(e,[{key:"bind",value:function(){var e=this.gl;return e.bindFramebuffer(e.FRAMEBUFFER,this.framebuffer),this}},{key:"unbind",value:function(){var e=this.gl;return e.bindFramebuffer(e.FRAMEBUFFER,null),this}},{key:"setColorTarget",value:function(e,t,r){var i=this.gl;if(!e)throw"Texture argument is missing";if(o[t]&&void 0===r&&(r=t,t=0),void 0===t)t=0;else if(!Number.isInteger(t)||t<0)throw"Texture color attachment index is invalid";if(r&&!o[r])throw"Texture target is invalid";return this.textures["color"+t]=e,this.bind(),i.framebufferTexture2D(i.FRAMEBUFFER,i["COLOR_ATTACHMENT"+t],i[r||"TEXTURE_2D"],e.texture,0),this.unbind(),this}},{key:"setDepthTarget",value:function(e){if(!e)throw"Texture argument is missing";if(!a[e.format])throw"Provided texture is not of format `DEPTH_COMPONENT` or `DEPTH_STENCIL`";var t=this.gl;return this.textures.depth=e,this.bind(),t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,e.texture,0),this.unbind(),this}},{key:"resize",value:function(e,t){if("number"!=typeof e||e<=0)throw"Provided `width` of "+e+" is invalid";if("number"!=typeof t||t<=0)throw"Provided `height` of "+t+" is invalid";var r=this.textures;return Object.keys(r).forEach(function(i){r[i].resize(e,t)}),this}}]),e}();t.exports=f}()},{"./WebGLContext":13}],5:[function(e,t,r){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}();!function(){function r(e){var t=null;e.forEach(function(e){if(null===t)t=e.count;else{if(t!==e.count)throw"VertexBuffers must all have the same count to be rendered without an IndexBuffer, mismatch of "+t+" and "+e.count+" found";console.log("count "+t+" === "+e.count)}})}function o(e){var t={};e.forEach(function(e){Object.keys(e.pointers).forEach(function(e){t[e]=t[e]||0,t[e]++})}),Object.keys(t).forEach(function(e){if(t[e]>1)throw"More than one attribute pointer exists for index `"+e+"`"})}var a=e("../core/VertexPackage"),f=e("../core/VertexBuffer"),u=e("../core/IndexBuffer"),s=function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];if(i(this,e),t.vertexBuffer||t.vertexBuffers)this.vertexBuffers=t.vertexBuffers||[t.vertexBuffer];else if(t.vertices){var n=new a(t.vertices);this.vertexBuffers=[new f(n)]}else this.vertexBuffers=[];t.indexBuffer?this.indexBuffer=t.indexBuffer:t.indices?this.indexBuffer=new u(t.indices):this.indexBuffer=null,this.indexBuffer||r(this.vertexBuffers),o(this.vertexBuffers)}return n(e,[{key:"draw",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return this.indexBuffer?(this.vertexBuffers.forEach(function(e){e.bind()}),this.indexBuffer.draw(e),this.vertexBuffers.forEach(function(e){e.unbind()})):(this.vertexBuffers.forEach(function(e){e.bind()}),this.vertexBuffers.length>0&&this.vertexBuffers[0].draw(e),this.vertexBuffers.forEach(function(e){e.unbind()})),this}}]),e}();t.exports=s}()},{"../core/IndexBuffer":3,"../core/VertexBuffer":10,"../core/VertexPackage":11}],6:[function(e,t,r){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}();!function(){function r(e,t){return e[t.name]?e[t.name].index:Object.keys(e).length}function o(e,t,i){var n=p.parseDeclarations([t,i],["uniform","attribute"]);n.forEach(function(t){if("attribute"===t.qualifier){var i=r(e.attributes,t);e.attributes[t.name]={type:t.type,index:i}}else e.uniforms[t.name]={type:t.type,func:T[t.type+(t.count>1?"[]":"")]}})}function a(e,t,r){var i=e.createShader(e[r]);if(e.shaderSource(i,t),e.compileShader(i),!e.getShaderParameter(i,e.COMPILE_STATUS))throw"An error occurred compiling the shaders:\n"+e.getShaderInfoLog(i);return i}function f(e){var t=e.gl,r=e.attributes;Object.keys(r).forEach(function(i){t.bindAttribLocation(e.program,r[i].index,i)})}function u(e){var t=e.gl,r=e.uniforms;Object.keys(r).forEach(function(i){var n=t.getUniformLocation(e.program,i);null===n?delete r[i]:r[i].location=n})}function s(e){return function(t){v.load({url:e,responseType:"text",success:function(e){t(null,e)},error:function(e){t(e,null)}})}}function h(e){return function(t){t(null,e)}}function c(e){return function(t){var r=[];e=e||[],e=Array.isArray(e)?e:[e],e.forEach(function(e){p.isGLSL(e)?r.push(h(e)):r.push(s(e))}),d.parallel(r,t)}}function l(e,t){var r=e.gl,i=t.common.join(""),n=t.vert.join(""),s=t.frag.join(""),h=a(r,i+n,"VERTEX_SHADER"),c=a(r,i+s,"FRAGMENT_SHADER");if(o(e,n,s),e.program=r.createProgram(),r.attachShader(e.program,h),r.attachShader(e.program,c),f(e),r.linkProgram(e.program),!r.getProgramParameter(e.program,r.LINK_STATUS))throw"An error occured linking the shader:\n"+r.getProgramInfoLog(e.program);u(e)}var E=e("./WebGLContext"),p=e("./ShaderParser"),d=e("../util/Async"),v=e("../util/XHRLoader"),T={bool:"uniform1i","bool[]":"uniform1iv",float:"uniform1f","float[]":"uniform1fv",int:"uniform1i","int[]":"uniform1iv",uint:"uniform1i","uint[]":"uniform1iv",vec2:"uniform2fv","vec2[]":"uniform2fv",ivec2:"uniform2iv","ivec2[]":"uniform2iv",vec3:"uniform3fv","vec3[]":"uniform3fv",ivec3:"uniform3iv","ivec3[]":"uniform3iv",vec4:"uniform4fv","vec4[]":"uniform4fv",ivec4:"uniform4iv","ivec4[]":"uniform4iv",mat2:"uniformMatrix2fv","mat2[]":"uniformMatrix2fv",mat3:"uniformMatrix3fv","mat3[]":"uniformMatrix3fv",mat4:"uniformMatrix4fv","mat4[]":"uniformMatrix4fv",sampler2D:"uniform1i",samplerCube:"uniform1i"},y=function(){function e(){var t=this,r=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=arguments.length<=1||void 0===arguments[1]?null:arguments[1];if(i(this,e),!r.vert)throw"Vertex shader argument `vert` has not been provided";if(!r.frag)throw"Fragment shader argument `frag` has not been provided";this.program=0,this.gl=E.get(),this.version=r.version||"1.00",this.attributes={},this.uniforms={},r.attributes&&r.attributes.forEach(function(e,r){t.attributes[e]={index:r}}),d.parallel({common:c(r.common),vert:c(r.vert),frag:c(r.frag)},function(e,r){return e?void(n&&setTimeout(function(){n(e,null)})):(l(t,r),void(n&&setTimeout(function(){n(null,t)})))})}return n(e,[{key:"use",value:function(){return this.gl.useProgram(this.program),this}},{key:"setUniform",value:function(e,t){var r=this.uniforms[e];if(!r)throw"No uniform found under name `"+e+"`";if(void 0===t||null===t)throw"Value passed for uniform `"+e+"` is undefined or null";return"boolean"==typeof t&&(t=t?1:0),"mat2"===r.type||"mat3"===r.type||"mat4"===r.type?this.gl[r.func](r.location,!1,t):this.gl[r.func](r.location,t),this}},{key:"setUniforms",value:function(e){var t=this;return Object.keys(e).forEach(function(r){t.setUniform(r,e[r])}),this}}]),e}();t.exports=y}()},{"../util/Async":15,"../util/XHRLoader":18,"./ShaderParser":7,"./WebGLContext":13}],7:[function(e,t,r){"use strict";!function(){function e(e){return e.replace(s,"")}function r(e){return e=e.replace(p,""),e.replace(d,"")}function i(e){return e.replace(h," ").replace(c," ").replace(l,"$2$4$6")}function n(e,t,r){var i=r.match(E),n=i[1],o=void 0===i[2]?1:parseInt(i[2],10);return{qualifier:e,type:t,name:n,count:o}}function o(e){var t=e.split(",").map(function(e){return e.trim()}),r=t.shift().split(" "),i=r.shift(),o=r.shift(),a=r.concat(t);return a.map(function(e){return n(i,o,e)})}function a(e,t){var r=e.split(";"),i=t.join("|"),n=new RegExp("\\b("+i+")\\b.*"),a=[];return r.forEach(function(e){var t=e.match(n);t&&(a=a.concat(o(t[0])))}),a}function f(e){var t={};return e.filter(function(e){return!t[e.name]&&(t[e.name]=!0,!0)})}function u(e){return e.replace(T,"")}var s=/(\/\*([\s\S]*?)\*\/)|(\/\/(.*)$)/gm,h=/(\r\n|\n|\r)/gm,c=/\s{2,}/g,l=/(\s*)(\[)(\s*)(\d+)(\s*)(\])(\s*)/g,E=/([a-zA-Z_][a-zA-Z0-9_]*)(?:\[(\d+)\])?/,p=/\bprecision\s+\w+\s+\w+;/g,d=/\b(highp|mediump|lowp)\s+/g,v=/void\s+main\s*\(\s*(void)*\s*\)\s*/im,T=/#([\W\w\s\d])(?:.*\\r?\n)*.*$/gm;t.exports={parseDeclarations:function(){var t=arguments.length<=0||void 0===arguments[0]?[]:arguments[0],n=arguments.length<=1||void 0===arguments[1]?[]:arguments[1];if(0===t.length||0===n.length)return[];t=Array.isArray(t)?t:[t],n=Array.isArray(n)?n:[n];var o=[];return t.forEach(function(t){t=u(t),t=r(t),t=e(t),t=i(t),o=o.concat(a(t,n))}),f(o)},isGLSL:function(e){return v.test(e)}}}()},{}],8:[function(e,t,r){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}();!function(){var r=e("./WebGLContext"),o=e("../util/Util"),a={NEAREST:!0,LINEAR:!0},f={NEAREST:!0,LINEAR:!0,NEAREST_MIPMAP_NEAREST:!0,LINEAR_MIPMAP_NEAREST:!0,NEAREST_MIPMAP_LINEAR:!0,LINEAR_MIPMAP_LINEAR:!0},u={NEAREST:!0,LINEAR:!0},s={NEAREST_MIPMAP_NEAREST:!0,LINEAR_MIPMAP_NEAREST:!0,NEAREST_MIPMAP_LINEAR:!0,LINEAR_MIPMAP_LINEAR:!0},h={REPEAT:!0,MIRRORED_REPEAT:!0,CLAMP_TO_EDGE:!0},c={DEPTH_COMPONENT:!0,DEPTH_STENCIL:!0},l="UNSIGNED_BYTE",E="RGBA",p="REPEAT",d="LINEAR",v=!0,T=!0,y=!0,m="_MIPMAP_LINEAR",_=function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];if(i(this,e),t.wrapS=t.wrapS||t.wrap,t.wrapT=t.wrapT||t.wrap,t.minFilter=t.minFilter||t.filter,t.magFilter=t.magFilter||t.filter,this.gl=r.get(),this.texture=null,this.wrapS=t.wrapS||p,this.wrapT=t.wrapT||p,this.minFilter=t.minFilter||d,this.magFilter=t.magFilter||d,this.mipMap=void 0!==t.mipMap?t.mipMap:T,this.invertY=void 0!==t.invertY?t.invertY:y,this.preMultiplyAlpha=void 0!==t.preMultiplyAlpha?t.preMultiplyAlpha:v,this.format=t.format||E,c[this.format]&&!r.checkExtension("WEBGL_depth_texture"))throw"Cannot create Texture2D of format `"+this.format+"` as `WEBGL_depth_texture` extension is unsupported";if(this.type=t.type||l,"FLOAT"===this.type&&!r.checkExtension("OES_texture_float"))throw"Cannot create Texture2D of type `FLOAT` as `OES_texture_float` extension is unsupported";if("string"!=typeof t.src){if(!o.isCanvasType(t.src)){if("number"!=typeof t.width||t.width<=0)throw"`width` argument is missing or invalid";if("number"!=typeof t.height||t.height<=0)throw"`height` argument is missing or invalid";if(o.mustBePowerOfTwo(this)){if(!o.isPowerOfTwo(t.width))throw"Parameters require a power-of-two texture, yet provided width of `"+t.width+"` is not a power of two";if(!o.isPowerOfTwo(t.height))throw"Parameters require a power-of-two texture, yet provided height of `"+t.height+"` is not a power of two"}}this.bufferData(t.src||null,t.width,t.height),this.setParameters(this)}}return n(e,[{key:"bind",value:function(){var e=arguments.length<=0||void 0===arguments[0]?0:arguments[0];if(!Number.isInteger(e)||e<0)throw"Texture unit location is invalid";var t=this.gl;return t.activeTexture(t["TEXTURE"+e]),t.bindTexture(t.TEXTURE_2D,this.texture),this}},{key:"unbind",value:function(){var e=this.gl;return e.bindTexture(e.TEXTURE_2D,null),this}},{key:"bufferData",value:function(e,t,r){var i=this.gl;if(this.texture||(this.texture=i.createTexture()),i.bindTexture(i.TEXTURE_2D,this.texture),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,this.invertY),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.preMultiplyAlpha),Array.isArray(e)&&(e="UNSIGNED_SHORT"===this.type?new Uint16Array(e):"UNSIGNED_INT"===this.type?new Uint32Array(e):"FLOAT"===this.type?new Float32Array(e):new Uint8Array(e)),e instanceof Uint8Array)this.type="UNSIGNED_BYTE";else if(e instanceof Uint16Array)this.type="UNSIGNED_SHORT";else if(e instanceof Uint32Array)this.type="UNSIGNED_INT";else if(e instanceof Float32Array)this.type="FLOAT";else if(e&&!(e instanceof ArrayBuffer)&&!o.isCanvasType(e))throw"Argument must be of type `Array`, `ArrayBuffer`, `ArrayBufferView`, `ImageData`, `HTMLImageElement`, `HTMLCanvasElement`, `HTMLVideoElement`, or null";return o.isCanvasType(e)?(this.width=e.width,this.height=e.height,i.texImage2D(i.TEXTURE_2D,0,i[this.format],i[this.format],i[this.type],e)):(this.width=t||this.width,this.height=r||this.height,i.texImage2D(i.TEXTURE_2D,0,i[this.format],this.width,this.height,0,i[this.format],i[this.type],e)),this.mipMap&&i.generateMipmap(i.TEXTURE_2D),i.bindTexture(i.TEXTURE_2D,null),this}},{key:"setParameters",value:function(e){var t=this.gl;t.bindTexture(t.TEXTURE_2D,this.texture);var r=e.wrapS||e.wrap;if(r){if(!h[r])throw"Texture parameter `"+r+"` is not a valid value for `TEXTURE_WRAP_S`";this.wrapS=r,t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t[this.wrapS])}if(r=e.wrapT||e.wrap){if(!h[r])throw"Texture parameter `"+r+"` is not a valid value for `TEXTURE_WRAP_T`";this.wrapT=r,t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t[this.wrapT])}if(r=e.magFilter||e.filter){if(!a[r])throw"Texture parameter `"+r+"` is not a valid value for 'TEXTURE_MAG_FILTER`";this.magFilter=r,t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t[this.magFilter])}if(r=e.minFilter||e.filter)if(this.mipMap){if(u[r]&&(r+=m),!s[r])throw"Texture parameter `"+r+"` is not a valid value for `TEXTURE_MIN_FILTER`";this.minFilter=r,t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t[this.minFilter])}else{if(!f[r])throw"Texture parameter `"+r+"` is not a valid value for `TEXTURE_MIN_FILTER`";this.minFilter=r,t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t[this.minFilter])}return t.bindTexture(t.TEXTURE_2D,this.texture),this}},{key:"resize",value:function(e,t){if("number"!=typeof e||e<=0)throw"Provided width of `"+e+"` is invalid";if("number"!=typeof t||t<=0)throw"Provided height of `"+t+"` is invalid";return this.bufferData(null,e,t),this}}]),e}();t.exports=_}()},{"../util/Util":17,"./WebGLContext":13}],9:[function(e,t,r){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}();!function(){function r(e){if("number"!=typeof e.width||e.width<=0)throw"`width` argument is missing or invalid";if("number"!=typeof e.height||e.height<=0)throw"`height` argument is missing or invalid";if(e.width!==e.height)throw"Provided `width` must be equal to `height`";if(h.mustBePowerOfTwo(e)&&!h.isPowerOfTwo(e.width))throw"Parameters require a power-of-two texture, yet provided size of "+e.width+" is not a power of two"}function o(e,t,r){return function(i){c.load({url:r,success:function(r){r=h.resizeCanvas(e,r),e.bufferData(t,r),i(null)},error:function(e){i(e,null)}})}}function a(e,t,r){return function(i){r=h.resizeCanvas(e,r),e.bufferData(t,r),i(null)}}function f(e,t,i){return r(e),function(r){e.bufferData(t,i),r(null)}}var u=e("./WebGLContext"),s=e("../util/Async"),h=e("../util/Util"),c=e("../util/ImageLoader"),l=["-x","+x","-y","+y","-z","+z"],E={"+z":"TEXTURE_CUBE_MAP_POSITIVE_Z","-z":"TEXTURE_CUBE_MAP_NEGATIVE_Z","+x":"TEXTURE_CUBE_MAP_POSITIVE_X","-x":"TEXTURE_CUBE_MAP_NEGATIVE_X","+y":"TEXTURE_CUBE_MAP_POSITIVE_Y","-y":"TEXTURE_CUBE_MAP_NEGATIVE_Y"},p={TEXTURE_CUBE_MAP_POSITIVE_Z:!0,TEXTURE_CUBE_MAP_NEGATIVE_Z:!0,TEXTURE_CUBE_MAP_POSITIVE_X:!0,TEXTURE_CUBE_MAP_NEGATIVE_X:!0,TEXTURE_CUBE_MAP_POSITIVE_Y:!0,TEXTURE_CUBE_MAP_NEGATIVE_Y:!0},d={NEAREST:!0,LINEAR:!0},v={NEAREST:!0,LINEAR:!0,NEAREST_MIPMAP_NEAREST:!0,LINEAR_MIPMAP_NEAREST:!0,NEAREST_MIPMAP_LINEAR:!0,LINEAR_MIPMAP_LINEAR:!0},T={NEAREST:!0,LINEAR:!0},y={NEAREST_MIPMAP_NEAREST:!0,LINEAR_MIPMAP_NEAREST:!0,NEAREST_MIPMAP_LINEAR:!0,LINEAR_MIPMAP_LINEAR:!0},m={REPEAT:!0,MIRRORED_REPEAT:!0,CLAMP_TO_EDGE:!0},_={RGB:!0,RGBA:!0},b="UNSIGNED_BYTE",g="RGBA",A="CLAMP_TO_EDGE",w="LINEAR",x=!0,R=!0,N=!0,I="_MIPMAP_LINEAR",P=function(){function e(){var t=this,n=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],c=arguments.length<=1||void 0===arguments[1]?null:arguments[1];if(i(this,e),this.gl=u.get(),this.texture=null,n.wrapS=n.wrapS||n.wrap,n.wrapT=n.wrapT||n.wrap,n.minFilter=n.minFilter||n.filter,n.magFilter=n.magFilter||n.filter,this.wrapS=m[n.wrapS]?n.wrapS:A,this.wrapT=m[n.wrapT]?n.wrapT:A,this.minFilter=v[n.minFilter]?n.minFilter:w,this.magFilter=d[n.magFilter]?n.magFilter:w,this.mipMap=void 0!==n.mipMap?n.mipMap:R,this.invertY=void 0!==n.invertY?n.invertY:N,this.preMultiplyAlpha=void 0!==n.preMultiplyAlpha?n.preMultiplyAlpha:x,this.format=_[n.format]?n.format:g,this.type=n.type||b,"FLOAT"===this.type&&!u.checkExtension("OES_texture_float"))throw"Cannot create Texture2D of type `FLOAT` as `OES_texture_float` extension is unsupported";this.width=n.width,this.height=n.height,this.bufferedFaces=[],n.faces?!function(){var e=[];l.forEach(function(r){var i=n.faces[r],u=E[r];"string"==typeof i?e.push(o(t,u,i)):h.isCanvasType(i)?e.push(a(t,u,i)):e.push(f(t,u,i))}),s.parallel(e,function(e){return e?void(c&&setTimeout(function(){c(e,null)})):(t.setParameters(t),void(c&&setTimeout(function(){c(null,t)})))})}():(r(this),l.forEach(function(e){t.bufferData(E[e],null)}),this.setParameters(this))}return n(e,[{key:"bind",value:function(){var e=arguments.length<=0||void 0===arguments[0]?0:arguments[0];if(!Number.isInteger(e)||e<0)throw"Texture unit location is invalid";var t=this.gl;return t.activeTexture(t["TEXTURE"+e]),t.bindTexture(t.TEXTURE_CUBE_MAP,this.texture),this}},{key:"unbind",value:function(){var e=this.gl;return e.bindTexture(e.TEXTURE_CUBE_MAP,null),this}},{key:"bufferData",value:function(e,t){if(!p[e])throw"Provided `target` of "+e+"  is invalid";var r=this.gl;if(this.texture||(this.texture=r.createTexture()),r.bindTexture(r.TEXTURE_CUBE_MAP,this.texture),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,this.invertY),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.preMultiplyAlpha),Array.isArray(t)&&(t="UNSIGNED_SHORT"===this.type?new Uint16Array(t):"UNSIGNED_INT"===this.type?new Uint32Array(t):"FLOAT"===this.type?new Float32Array(t):new Uint8Array(t)),t instanceof Uint8Array)this.type="UNSIGNED_BYTE";else if(t instanceof Uint16Array)this.type="UNSIGNED_SHORT";else if(t instanceof Uint32Array)this.type="UNSIGNED_INT";else if(t instanceof Float32Array)this.type="FLOAT";else if(t&&!(t instanceof ArrayBuffer)&&!h.isCanvasType(t))throw"Argument must be of type `Array`, `ArrayBuffer`, `ArrayBufferView`, `ImageData`, `HTMLImageElement`, `HTMLCanvasElement`, `HTMLVideoElement`, or null";return h.isCanvasType(t)?(this.width=t.width,this.height=t.height,r.texImage2D(r[e],0,r[this.format],r[this.format],r[this.type],t)):r.texImage2D(r[e],0,r[this.format],this.width,this.height,0,r[this.format],r[this.type],t),this.bufferedFaces.indexOf(e)<0&&this.bufferedFaces.push(e),this.mipMap&&6===this.bufferedFaces.length&&r.generateMipmap(r.TEXTURE_CUBE_MAP),r.bindTexture(r.TEXTURE_CUBE_MAP,null),this}},{key:"setParameters",value:function(e){var t=this.gl;t.bindTexture(t.TEXTURE_CUBE_MAP,this.texture);var r=e.wrapS||e.wrap;if(r){if(!m[r])throw"Texture parameter `"+r+"` is not a valid value for `TEXTURE_WRAP_S`";this.wrapS=r,t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_WRAP_S,t[this.wrapS])}if(r=e.wrapT||e.wrap){if(!m[r])throw"Texture parameter `"+r+"` is not a valid value for `TEXTURE_WRAP_T`";this.wrapT=r,t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_WRAP_T,t[this.wrapT])}if(r=e.magFilter||e.filter){if(!d[r])throw"Texture parameter `"+r+"` is not a valid value for 'TEXTURE_MAG_FILTER`";this.magFilter=r,t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t[this.magFilter])}if(r=e.minFilter||e.filter)if(this.mipMap){if(T[r]&&(r+=I),!y[r])throw"Texture parameter `"+r+"` is not a valid value for `TEXTURE_MIN_FILTER`";this.minFilter=r,t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t[this.minFilter])}else{if(!v[r])throw"Texture parameter `"+r+"` is not a valid value for `TEXTURE_MIN_FILTER`";this.minFilter=r,t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t[this.minFilter])}return t.bindTexture(t.TEXTURE_CUBE_MAP,null),this}}]),e}();t.exports=P}()},{"../util/Async":15,"../util/ImageLoader":16,"../util/Util":17,"./WebGLContext":13}],10:[function(e,t,r){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}();!function(){function r(e){var t=Object.keys(e);if(1===t.length)return 0;var r=0,i=0,n=0;return t.forEach(function(t){var o=e[t],a=o.byteOffset,f=o.size,u=o.type;i+=f*h[u],a>r&&(r=a,n=a+f*h[u])}),r>=i?0:n}function o(e){var t={};return Object.keys(e).forEach(function(r){var i=parseInt(r,10);if(isNaN(i))throw"Attribute index `"+r+"` does not represent an integer";var n=e[r],o=n.size,a=n.type,f=n.byteOffset;if(!c[o])throw"Attribute pointer `size` parameter is invalid, must be one of "+JSON.stringify(Object.keys(c));if(!s[a])throw"Attribute pointer `type` parameter is invalid, must be one of "+JSON.stringify(Object.keys(s));t[i]={size:o,type:a,byteOffset:void 0!==f?f:l}}),t}var a=e("./WebGLContext"),f=e("./VertexPackage"),u={POINTS:!0,LINES:!0,LINE_STRIP:!0,LINE_LOOP:!0,TRIANGLES:!0,TRIANGLE_STRIP:!0,TRIANGLE_FAN:!0},s={BYTE:!0,UNSIGNED_BYTE:!0,SHORT:!0,UNSIGNED_SHORT:!0,FIXED:!0,FLOAT:!0},h={BYTE:1,UNSIGNED_BYTE:1,SHORT:2,UNSIGNED_SHORT:2,FIXED:4,FLOAT:4},c={1:!0,2:!0,3:!0,4:!0},l=0,E="TRIANGLES",p=0,d=0,v=function(){function e(t){var n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],s=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];if(i(this,e),this.gl=a.get(),this.buffer=null,this.mode=u[s.mode]?s.mode:E,this.count=void 0!==s.count?s.count:d,this.indexOffset=void 0!==s.indexOffset?s.indexOffset:p,this.byteLength=0,t&&t.buffer&&t.pointers?(this.pointers=t.pointers,s=n):this.pointers=o(n),this.byteStride=r(this.pointers),t)if(t instanceof f)this.bufferData(t.buffer);else if(t instanceof WebGLBuffer){if(void 0===s.byteLength)throw"Argument of type `WebGLBuffer` must be complimented with a corresponding `options.byteLength`";this.buffer=t,this.byteLength=s.byteLength}else this.bufferData(t)}return n(e,[{key:"bufferData",value:function(e){var t=this.gl;if(Array.isArray(e))e=new Float32Array(e);else if(!(e instanceof ArrayBuffer||ArrayBuffer.isView(e)||Number.isInteger(e)))throw"Argument must be of type `Array`, `ArrayBuffer`, `ArrayBufferView`, or `Number`";Number.isInteger(e)?this.byteLength=e:this.byteLength=e.byteLength,this.buffer||(this.buffer=t.createBuffer()),t.bindBuffer(t.ARRAY_BUFFER,this.buffer),
t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW)}},{key:"bufferSubData",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?l:arguments[1],r=this.gl;if(!this.buffer)throw"Buffer has not yet been allocated, allocate with `bufferData`";if(Array.isArray(e))e=new Float32Array(e);else if(!(e instanceof ArrayBuffer||ArrayBuffer.isView(e)))throw"Argument must be of type `Array`, `ArrayBuffer`, or `ArrayBufferView`";if(t+e.byteLength>this.byteLength)throw"Argument of length "+e.byteLength+" bytes with "+("offset of "+t+" bytes overflows the buffer ")+("length of "+this.byteLength+" bytes");return r.bindBuffer(r.ARRAY_BUFFER,this.buffer),r.bufferSubData(r.ARRAY_BUFFER,t,e),this}},{key:"bind",value:function(){var e=this,t=this.gl;return t.bindBuffer(t.ARRAY_BUFFER,this.buffer),Object.keys(this.pointers).forEach(function(r){var i=e.pointers[r];t.vertexAttribPointer(r,i.size,t[i.type],!1,e.byteStride,i.byteOffset),t.enableVertexAttribArray(r)}),this}},{key:"unbind",value:function(){var e=this.gl;return e.bindBuffer(e.ARRAY_BUFFER,this.buffer),Object.keys(this.pointers).forEach(function(t){e.disableVertexAttribArray(t)}),this}},{key:"draw",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=this.gl,r=t[e.mode||this.mode],i=void 0!==e.indexOffset?e.indexOffset:this.indexOffset,n=void 0!==e.count?e.count:this.count;if(0===n)throw"Attempting to draw with a count of 0";return t.drawArrays(r,i,n),this}}]),e}();t.exports=v}()},{"./VertexPackage":11,"./WebGLContext":13}],11:[function(e,t,r){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}();!function(){function e(e){var t=[];return Object.keys(e).forEach(function(r){var i=parseFloat(r);if(!Number.isInteger(i)||i<0)throw"Attribute index `"+r+"` does not represent a valid integer";var n=e[r];if(!(Array.isArray(n)&&n.length>0))throw"Error parsing attribute of index `"+i+"`";t.push({index:i,data:n})}),t.sort(function(e,t){return e.index-t.index}),t}function r(e){return Array.isArray(e)?e.length:void 0!==e.x&&void 0!==e.y?void 0!==e.z?void 0!==e.w?4:3:2:1}function o(e,t){var i=Number.MAX_VALUE,n=0;e.pointers={},t.forEach(function(t){var o=r(t.data[0]);i=Math.min(i,t.data.length),e.pointers[t.index]={type:h,size:o,byteOffset:n*c},n+=o}),e.stride=n,e.length=i}function a(e,t,r,i,n){var o=void 0,a=void 0,f=void 0;for(a=0;a<r;a++)o=t[a],f=i+n*a,void 0!==o.x?e[f]=o.x:void 0!==o[0]?e[f]=o[0]:e[f]=o}function f(e,t,r,i,n){var o=void 0,a=void 0,f=void 0;for(a=0;a<r;a++)o=t[a],f=i+n*a,e[f]=void 0!==o.x?o.x:o[0],e[f+1]=void 0!==o.y?o.y:o[1]}function u(e,t,r,i,n){var o=void 0,a=void 0,f=void 0;for(a=0;a<r;a++)o=t[a],f=i+n*a,e[f]=void 0!==o.x?o.x:o[0],e[f+1]=void 0!==o.y?o.y:o[1],e[f+2]=void 0!==o.z?o.z:o[2]}function s(e,t,r,i,n){var o=void 0,a=void 0,f=void 0;for(a=0;a<r;a++)o=t[a],f=i+n*a,e[f]=void 0!==o.x?o.x:o[0],e[f+1]=void 0!==o.y?o.y:o[1],e[f+2]=void 0!==o.z?o.z:o[2],e[f+3]=void 0!==o.w?o.w:o[3]}var h="FLOAT",c=4,l=function(){function t(e){i(this,t),void 0!==e?this.set(e):(this.buffer=new Float32Array(0),this.pointers={})}return n(t,[{key:"set",value:function(t){t=e(t),o(this,t);var r=this.length,i=this.stride,n=this.pointers,h=this.buffer=new Float32Array(r*i);return t.forEach(function(e){var t=n[e.index],o=t.byteOffset/c;switch(t.size){case 2:f(h,e.data,r,o,i);break;case 3:u(h,e.data,r,o,i);break;case 4:s(h,e.data,r,o,i);break;default:a(h,e.data,r,o,i)}}),this}}]),t}();t.exports=l}()},{}],12:[function(e,t,r){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}();!function(){function r(e,t,r,i,n){var o=e.gl;t=void 0!==t?t:e.x,r=void 0!==r?r:e.y,i=void 0!==i?i:e.width,n=void 0!==n?n:e.height,o.viewport(t,r,i,n)}var o=e("./WebGLContext"),a=function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];i(this,e),this.gl=o.get(),this.stack=[],this.resize(t.width||this.gl.canvas.width,t.height||this.gl.canvas.height)}return n(e,[{key:"resize",value:function(){var e=arguments.length<=0||void 0===arguments[0]?0:arguments[0],t=arguments.length<=1||void 0===arguments[1]?0:arguments[1];if("number"!=typeof e||e<=0)throw"Provided `width` of `"+e+"` is invalid";if("number"!=typeof t||t<=0)throw"Provided `height` of `"+t+"` is invalid";return this.width=e,this.height=t,this.gl.canvas.width=e,this.gl.canvas.height=t,this}},{key:"push",value:function(){var e=arguments.length<=0||void 0===arguments[0]?0:arguments[0],t=arguments.length<=1||void 0===arguments[1]?0:arguments[1],i=arguments.length<=2||void 0===arguments[2]?this.width:arguments[2],n=arguments.length<=3||void 0===arguments[3]?this.height:arguments[3];if("number"!=typeof e)throw"Provided `x` of `"+e+"` is invalid";if("number"!=typeof t)throw"Provided `y` of `"+t+"` is invalid";if("number"!=typeof i||i<=0)throw"Provided `width` of `"+i+"` is invalid";if("number"!=typeof n||n<=0)throw"Provided `height` of `"+n+"` is invalid";return this.stack.push({x:e,y:t,width:i,height:n}),r(this,e,t,i,n),this}},{key:"pop",value:function(){if(0===this.stack.length)throw"Viewport stack is empty";if(this.stack.pop(),this.stack.length>0){var e=this.stack[this.stack.length-1];r(this,e.x,e.y,e.width,e.height)}else r(this);return this}}]),e}();t.exports=a}()},{"./WebGLContext":13}],13:[function(e,t,r){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};!function(){function e(){var e=function(e){var t=16*Math.random()|0,r="x"===e?t:3&t|8;return r.toString(16)};return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e)}function r(t){return t.id||(t.id=e()),t.id}function n(e){return e instanceof HTMLCanvasElement?e:"string"==typeof e?document.getElementById(e)||document.querySelector(e):null}function o(e){if(void 0===e){if(s)return s}else{var t=n(e);if(t)return h[r(t)]}return null}function a(e){var t=e.gl;u.forEach(function(r){e.extensions[r]=t.getExtension(r)})}function f(e,t){var i=e.getContext("webgl",t)||e.getContext("experimental-webgl",t),n={id:r(e),gl:i,extensions:{}};return a(n),h[r(e)]=n,s=n,n}var u=["OES_texture_float","OES_texture_half_float","WEBGL_lose_context","OES_standard_derivatives","OES_vertex_array_object","WEBGL_debug_renderer_info","WEBGL_debug_shaders","WEBGL_compressed_texture_s3tc","WEBGL_depth_texture","OES_element_index_uint","EXT_texture_filter_anisotropic","EXT_frag_depth","WEBGL_draw_buffers","ANGLE_instanced_arrays","OES_texture_float_linear","OES_texture_half_float_linear","EXT_blend_minmax","EXT_shader_texture_lod","WEBGL_compressed_texture_atc","WEBGL_compressed_texture_pvrtc","EXT_color_buffer_half_float","WEBGL_color_buffer_float","EXT_sRGB","WEBGL_compressed_texture_etc1","EXT_disjoint_timer_query","EXT_color_buffer_float"],s=null,h={};t.exports={bind:function(e){var t=o(e);if(t)return s=t,this;throw"No context exists for provided argument '"+e+"'"},get:function(e,t){var r=o(e);if(r)return r.gl;var a=n(e);if(!a)throw"No context is currently bound or could be associated with provided argument of type "+("undefined"==typeof e?"undefined":i(e));return f(a,t).gl},remove:function(e){var t=o(e);if(!t)throw"No context is currently bound or could be associated with provided argument of type "+("undefined"==typeof e?"undefined":i(e));delete h[t.id],t===s&&(s=null)},supportedExtensions:function(e){var t=o(e);if(t){var r=function(){var e=t.extensions,r=[];return Object.keys(e).forEach(function(t){e[t]&&r.push(t)}),{v:r}}();if("object"===("undefined"==typeof r?"undefined":i(r)))return r.v}throw"No context is currently bound or could be associated with provided argument of type "+("undefined"==typeof e?"undefined":i(e))},unsupportedExtensions:function(e){var t=o(e);if(t){var r=function(){var e=t.extensions,r=[];return Object.keys(e).forEach(function(t){e[t]||r.push(t)}),{v:r}}();if("object"===("undefined"==typeof r?"undefined":i(r)))return r.v}throw"No context is currently bound or could be associated with provided argument of type "+("undefined"==typeof e?"undefined":i(e))},checkExtension:function(e,t){t||(t=e,e=void 0);var r=o(e);if(r){var n=r.extensions;return!!n[t]}throw"No context is currently bound or could be associated with provided argument of type "+("undefined"==typeof e?"undefined":i(e))},getExtension:function(e,t){t||(t=e,e=void 0);var r=o(e);if(r){var n=r.extensions;return n[t]||null}throw"No context is currently bound or could be associated with provided argument of type "+("undefined"==typeof e?"undefined":i(e))}}}()},{}],14:[function(e,t,r){"use strict";!function(){t.exports={IndexBuffer:e("./core/IndexBuffer"),Renderable:e("./core/Renderable"),RenderTarget:e("./core/RenderTarget"),Shader:e("./core/Shader"),Texture2D:e("./core/Texture2D"),ColorTexture2D:e("./core/ColorTexture2D"),DepthTexture2D:e("./core/DepthTexture2D"),TextureCubeMap:e("./core/TextureCubeMap"),VertexBuffer:e("./core/VertexBuffer"),VertexPackage:e("./core/VertexPackage"),Viewport:e("./core/Viewport"),WebGLContext:e("./core/WebGLContext")}}()},{"./core/ColorTexture2D":1,"./core/DepthTexture2D":2,"./core/IndexBuffer":3,"./core/RenderTarget":4,"./core/Renderable":5,"./core/Shader":6,"./core/Texture2D":8,"./core/TextureCubeMap":9,"./core/VertexBuffer":10,"./core/VertexPackage":11,"./core/Viewport":12,"./core/WebGLContext":13}],15:[function(e,t,r){"use strict";!function(){function e(e){var t=-1,r=void 0;if(Array.isArray(e))return r=e.length,function(){return t++,t<r?t:null};var i=Object.keys(e);return r=i.length,function(){return t++,t<r?i[t]:null}}function r(e){return function(){null!==e&&(e.apply(this,arguments),e=null)}}function i(t,i,n){function o(e){f--,e?n(e):null===a&&f<=0&&n(null)}n=r(n);for(var a=void 0,f=0,u=e(t);null!==(a=u());)f+=1,i(t[a],a,o);0===f&&n(null)}t.exports={parallel:function(e,t){var r=Array.isArray(e)?[]:{};i(e,function(e,t,i){e(function(e,n){r[t]=n,i(e)})},function(e){t(e,r)})}}}()},{}],16:[function(e,t,r){"use strict";!function(){t.exports={load:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=new Image;t.onload=function(){e.success&&e.success(t)},t.onerror=function(t){if(e.error){var r="Unable to load image from URL: `"+t.path[0].currentSrc+"`";e.error(r)}},t.src=e.url}}}()},{}],17:[function(e,t,r){"use strict";!function(){var e={};e.isCanvasType=function(e){return e instanceof ImageData||e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement},e.mustBePowerOfTwo=function(e){return e.mipMap||"REPEAT"===e.wrapS||"MIRRORED_REPEAT"===e.wrapS||"REPEAT"===e.wrapT||"MIRRORED_REPEAT"===e.wrapT},e.isPowerOfTwo=function(e){return 0!==e&&0===(e&e-1)},e.nextHighestPowerOfTwo=function(e){var t=void 0;for(0!==e&&(e-=1),t=1;t<32;t<<=1)e|=e>>t;return e+1},e.resizeCanvas=function(t,r){if(!e.mustBePowerOfTwo(t)||e.isPowerOfTwo(r.width)&&e.isPowerOfTwo(r.height))return r;var i=document.createElement("canvas");i.width=e.nextHighestPowerOfTwo(r.width),i.height=e.nextHighestPowerOfTwo(r.height);var n=i.getContext("2d");return n.drawImage(r,0,0,r.width,r.height,0,0,i.width,i.height),i},t.exports=e}()},{}],18:[function(e,t,r){"use strict";!function(){t.exports={load:function(e){var t=new XMLHttpRequest;t.open("GET",e.url,!0),t.responseType=e.responseType,t.onreadystatechange=function(){4===t.readyState&&(200===t.status?e.success&&e.success(t.response):e.error&&e.error("GET "+t.responseURL+" "+t.status+" ("+t.statusText+")"))},t.send()}}}()},{}]},{},[14])(14)});